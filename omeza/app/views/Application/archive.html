#{extends 'main.html' /}
#{set title:'Home' /}

#{set 'styles'}
<style type="text/css">
table.list{
    background: #ffc;
    border: solid 2px #c93;
    border-collapse: collapse;
    padding: 10px;
    font-family: Verdana, sans-serif;
    }
table.list th,
table.list td {
    border: 1px solid #c93;
    text-align: center;
    font-family: Verdana, sans-serif;
    padding: 10px;
}
table.list thead th{
    background: #fc9;
    border-bottom: 2px solid #c93;
}
#long-graph,  #long-chart {
    background: #ffc;
    border: solid 2px #c93;
    padding: 10px;
    font-family: Verdana, sans-serif;
    width: 450px;
    }
</style>
#{/}

#{set 'scripts'}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
#{/}

%{ m = play.i18n.Messages.&get }%
<br/>
<div>

<!-- a style="display: block !important" onclick="javascript:toggle('year<%= year %>');">▼<%= year %></a -->
  <!-- div id="year<%= year %>" -->

<script>
function confirmDelete(periodId) {
    if (confirm("Really delete?")) {
        $.post("@{Period.delete()}",
            {periodId: periodId},
            function() {
                $("#periodTR" + periodId).fadeOut();
            }
        );
    }
}
</script>

<table id="tbl-<%= year %>" class="list" cellspacing="0">
  <thead>
    <tr>
        <th>&{'archive.start'}</th>
        <th>&{'archive.end'}</th>
        <th>&{'archive.length'}</th>
        <th>&{'archive.delete'}</th>
    </tr>
  </thead>
  <tbody>
#{list periods, as:'period'}
      <tr id="periodTR${period.id}">
        <td><a href="@{Application.period(period.id)}">${period.start.format(m('dateformat'))}</a></td>
        <td>${period.end.format(m('dateformat'))}</td>
        <td>${period.length()}</td>
        <td><button onclick="confirmDelete(${period.id})">Delete</button></td>
      </tr>
#{/}
      <tr id="period-other">
      </tr>
    <tbody>
  </table>

  </div>
  <br/>
  <% year_start = yperiods[0].start_date.to_s %>
  <% year_end = yperiods[yperiods.length-1].end_date.to_s %>
  <div id="long-graph">
    <font color="f93">長期グラフ</font><br>
    <form name="graphform" action="<%= url_for :controller=>'periods', :action=>'long_graph' %>">
    <input id="startdate" name="startdate" value="<%= year_start %>" type="hidden"/>
    <input id="enddate" name="enddate" value="<%= year_end %>" type="hidden"/>
    <a id="_startdate_link" href="#" onclick="DatePicker.toggleDatePicker('startdate')" class="demo_link"><%= year_start %></a>　　から　　<a id="_enddate_link" href="#" onclick="DatePicker.toggleDatePicker('enddate')" class="demo_link"><%= year_end %></a>　　まで&nbsp;&nbsp;<%= submit_tag '表示' %>
    </form>
  </div>
  <div id="_startdate_calendar" class="date_picker" style="display:none"></div>
  <div id="_enddate_calendar" class="date_picker" style="display:none"></div>
  <br>
  <div id="long-chart">
    <font color="f93">長期データ</font><br>
    <form name="graphform2" action="<%= url_for :controller=>'periods', :action=>'long_data' %>">
    <input id="startdate2" name="startdate2" value="<%= year_start %>" type="hidden"/>
    <input id="enddate2" name="enddate2" value="<%= year_end %>" type="hidden"/>
    <a id="_startdate2_link" href="#" onclick="DatePicker.toggleDatePicker('startdate2')" class="demo_link"><%= year_start %></a>　　から　　<a id="_enddate2_link" href="#" onclick="DatePicker.toggleDatePicker('enddate2')" class="demo_link"><%= year_end %></a>　　まで&nbsp;&nbsp;<%= submit_tag '表示' %>
    </form>
  </div>
  <div id="_startdate2_calendar" class="date_picker" style="display:none"></div>
  <div id="_enddate2_calendar" class="date_picker" style="display:none"></div>
<br/>

